
terraform {
  required_providers {
    azurerm={
        source = "hashicorp/azurerm"
        version = "4.44.0"
    }
  }
}

provider "azurerm" {
    subscription_id = "9318f5ba-4f84-45d0-b654-9de4c9875f0a"
    client_id = "c490c805-f9ad-46a9-9c38-5635d3bc15f9"
    client_secret = "Jgi8Q~qMKqd7f.Wj4sTKToOqJLNWDg3gAXmpCc.K"
    tenant_id = "edb76449-7354-4c81-af20-0123d083eb8a"
  features {}
}
#Resource Group
resource "azurerm_resource_group" "myrg" {
  name = "Dev-RG"
  location = "Central India"
}

#Vnet1
resource "azurerm_virtual_network" "myvnet1" {
  name = "Vnet1"
  location = azurerm_resource_group.myrg.location
  resource_group_name = azurerm_resource_group.myrg.name
  address_space = ["10.0.0.0/16"]
}

#Vnet2
resource "azurerm_virtual_network" "myvnet2" {
  name = "Vnet2"
  location = azurerm_resource_group.myrg.location
  resource_group_name = azurerm_resource_group.myrg.name
  address_space = ["10.1.0.0/16"]
}

#Peering from Vnet1 to Vnet2
resource "azurerm_virtual_network_peering" "vnet1tovnet2" {
name = "Vnet1-to-Vnet2"
resource_group_name = azurerm_resource_group.myrg.name
virtual_network_name = azurerm_virtual_network.myvnet1.name
remote_virtual_network_id = azurerm_virtual_network.myvnet2.id
allow_virtual_network_access = true
}

#Peering from Vnet2 to Vnet1

resource "azurerm_virtual_network_peering" "name" {
  name = "Vnet2-to-Vnet1"
  resource_group_name = azurerm_resource_group.myrg.name
  virtual_network_name = azurerm_virtual_network.myvnet2.name
  remote_virtual_network_id = azurerm_virtual_network.myvnet1.id
  allow_virtual_network_access = true
}
